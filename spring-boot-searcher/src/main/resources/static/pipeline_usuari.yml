  input {
    jdbc {
    jdbc_driver_library => "/home/dario/logstash/ojdbc7.jar"
    jdbc_driver_class => "Java::oracle.jdbc.driver.OracleDriver"
    jdbc_connection_string => "jdbc:oracle:thin:@oracledes2.a11.altran.es:1521:DESorcl2"
    jdbc_user => "1671_SOCEXT"
    jdbc_password => "1671_SOCEXT"
    jdbc_paging_enabled => true
    tracking_column => "unix_ts_in_secs"
    use_column_value => true
    tracking_column_type => "timestamp"
    schedule => "*/30 * * * * *"
    statement => "SELECT DISTINCT p.id  AS programId,
  p.descripcio        AS nomPrograma,
  upper(u.screenname) AS nif,
  u.createdate        AS dataCreacio,
  u.status            AS status,
  u.emailaddress      AS correuElectronic,
  o.name              AS oficina,
  o.organizationid    AS organizationid,
  u.userid            AS id,
  u.firstname         AS nom,
  u.lastname          AS cognoms,
  u.modifieddate      AS unix_ts_in_secs,
  (SELECT r.name
  FROM users_roles ur
  INNER JOIN role_ r
  ON ur.roleid    = r.roleid
  WHERE ur.userid = u.userid
  AND r.name NOT IN ('User', 'Power User')
  AND rownum     <= 1
  ) AS rol
  FROM user_ u
  INNER JOIN users_orgs uo
  ON uo.userid = u.userid
  INNER JOIN organization_ o
  ON o.organizationid = uo.organizationid
  INNER JOIN programa_org po
  ON po.organizationid = o.organizationid
  INNER JOIN programa p
  ON p.id                = po.id_programa
  WHERE (u.modifieddate > :sql_last_value AND u.modifieddate < SYSDATE)
  ORDER BY u.modifieddate asc"
    lowercase_column_names => true
    }
  }
    filter {
    mutate {
    copy => { "id" => "[@metadata][_id]"}
    remove_field => ["id", "@version", "unix_ts_in_secs"]
    }
  }

    output {
    elasticsearch {
    id => "esoutput"
    hosts => "elasticsearch-74.db.dev.ctti.altran.kas:80"
    document_id => "%{[@metadata][_id]}"
    index => "usuari"
    ilm_enabled => false
    }
  }
